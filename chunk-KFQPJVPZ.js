import{a as r}from"./chunk-IXDNPNBC.js";import{a,b as O}from"./chunk-JIN3BOXY.js";import{a as g}from"./chunk-6EH4JDCG.js";import{a as s,c as _}from"./chunk-3GCZ6EJH.js";import{n as v}from"./chunk-UQ6JH2GH.js";import{Db as h,Ja as m,M as l,Mb as C,Nb as k,Ob as T,da as u,ia as c,na as f,nc as S,o as d,qb as p}from"./chunk-YNBU5IFA.js";var A=(()=>{let t=class t{constructor(n,e){this._networkService=n,this._router=e,this.isRefreshTokenCalled=!1,this.isLoggingIn=p(!1),this.isLogoutCalled=!1,this.refreshToken$=new d}login(n,e){this.isLoggingIn.set(!0),this._networkService.post(s.AUTHENTICATION.login,{username:n,password:e}).pipe(l(1)).subscribe({next:i=>{i&&i.data&&(this.isLogoutCalled=!1,this.isRefreshTokenCalled=!1,a(r.SS.token,i.data.accessToken),a(r.SS.username,i.data.username),a(r.SS.name,i.data.name),a(r.SS.user,JSON.stringify(i.data)),this._router.navigateByUrl(g.LAYOUT.route)),this.isLoggingIn.set(!1)},error:()=>{this.isLoggingIn.set(!1)}})}logOut(n){let e=O(r.SS.username);!this.isLogoutCalled&&this._networkService.post(s.AUTHENTICATION.logout,{isFromInterceptor:n,username:e}).pipe(l(1)).subscribe(),sessionStorage.clear(),this._router.navigateByUrl(g.LOGIN.route),this.refreshToken$.next(null),this.isLogoutCalled=!0}callRefreshToken(){return this._networkService.post(s.AUTHENTICATION.refresh,{})}successfulRefreshToken(n){let e=n.data?.accessToken;e?(a(r.SS.token,e),this.isRefreshTokenCalled=!1,this.refreshToken$.next(e)):this.logOut(!0)}};t.\u0275fac=function(e){return new(e||t)(c(_),c(v))},t.\u0275prov=u({token:t,factory:t.\u0275fac,providedIn:"root"});let o=t;return o})();var G=(()=>{let t=class t{constructor(){this.innerLoading=m(!1)}};t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=f({type:t,selectors:[["kss-lib-loading"]],inputs:{innerLoading:[1,"innerLoading"]},standalone:!0,features:[S],decls:5,vars:2,consts:[[1,"loading-route-container"],[1,"loading-circle"]],template:function(e,i){e&1&&(C(0,"div",0)(1,"div",1),T(2,"div")(3,"div")(4,"div"),k()()),e&2&&h("inner-loading",i.innerLoading())},styles:[".loading-route-container[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background-color:var(--spinner-background);z-index:99999;pointer-events:none;-webkit-user-select:none;user-select:none;display:flex;align-items:center;justify-content:center}.loading-route-container[_ngcontent-%COMP%]   .loading-circle[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center}.loading-route-container[_ngcontent-%COMP%]   .loading-circle[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(2){animation-delay:-.4s}.loading-route-container[_ngcontent-%COMP%]   .loading-circle[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(3){animation-delay:-.2s}.loading-route-container[_ngcontent-%COMP%]   .loading-circle[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{background-color:#fff;border-radius:50%;position:absolute;opacity:0;width:60px;height:60px;animation:_ngcontent-%COMP%_ball-scale-multiple 1s 0s linear infinite}.inner-loading[_ngcontent-%COMP%]{background-color:var(--inner-spinner-background)!important}@keyframes _ngcontent-%COMP%_ball-scale-multiple{0%{transform:scale(0);opacity:0}5%{opacity:1}to{transform:scale(1);opacity:0}}"]});let o=t;return o})();export{A as a,G as b};
